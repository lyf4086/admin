webpackJsonp([8],{KFn4:function(e,t){},a6IE:function(e,t){},hbze:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("mvHQ"),s=a.n(i),n={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"main"},[a("ul",{staticClass:"nav-list"},e._l(6,function(t){return a("li",{staticClass:"nav-item"},[a("div",{staticClass:"bg-pic"}),e._v(" "),e._m(0,!0)])})),e._v(" "),a("div",{staticClass:"search-wrap"},[a("div",{staticClass:"more"}),e._v(" "),a("div",{staticClass:"input-wrap"},[a("div",{staticClass:"sel"},[a("span",{staticClass:"text"},[e._v(e._s(e.text))]),e._v(" "),a("span",{staticClass:"btn-l",class:{"btn-b":this.isShow},on:{click:e.seltext}}),e._v(" "),a("ul",{staticClass:"list ",class:{active:this.isShow}},e._l(e.txtarr,function(t){return a("li",{on:{click:function(a){e.seltxt(t)}}},[e._v(e._s(t))])}))]),e._v(" "),e._m(1)])])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"text-wrap"},[t("span",[this._v("持枪人员")]),this._v(" "),t("i",[this._v("X")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"put-btn"},[t("input",{attrs:{type:"text"}}),this._v(" "),t("button")])}]};var o=a("VU/8")({data:function(){return{input5:"",select:"",isShow:!1,text:"默认文字",txtarr:["111111","22222","333333","4444","55555"]}},methods:{seltext:function(){this.isShow=!this.isShow},seltxt:function(e){this.text=e,this.isShow=!1}}},n,!1,function(e){a("a6IE")},"data-v-4eb7602b",null).exports,c={props:{del:{type:Boolean,default:!1},dataList:{type:Array,default:function(){return[]}}},data:function(){return{sync:0}},methods:{queren:function(e){confirm("是否删除")&&this.$emit("deleted",{item:e})},xiuGaiOneData:function(e){this.$emit("changeOneData",e)}},created:function(){this.sync=this.$store.state.sync}},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"sixitem"},e._l(this.dataList,function(t,i){return a("div",{key:i,class:{dou:e.del}},[a("div",{staticClass:"text deltext"},[a("p",[a("span",[e._v("机构名称：")]),e._v(" "),a("i",[e._v(e._s(t.mechanism_name))])]),e._v(" "),a("p",{directives:[{name:"show",rawName:"v-show",value:t.opoliceuser_name,expression:"item.opoliceuser_name"}]},[a("span",[e._v("创建人：")]),e._v(" "),a("i",[e._v(e._s(t.opoliceuser_name))])]),e._v(" "),a("p",[a("span",[e._v("创建时间：")]),e._v(" "),a("i",[e._v(e._s(t.date))])]),e._v(" "),a("p",[a("span",[e._v("机构编号：")]),e._v(" "),a("i",[e._v(e._s(t.code))])]),e._v(" "),a("p",{directives:[{name:"show",rawName:"v-show",value:t.mechanism_desc,expression:"item.mechanism_desc"}]},[a("span",[e._v("机构描述：")]),e._v(" "),a("i",[e._v(e._s(t.mechanism_desc))])])]),e._v(" "),0===e.sync?a("button",{staticClass:"change",on:{click:function(a){e.xiuGaiOneData(t)}}},[e._v("修改机构")]):e._e(),e._v(" "),a("button",{directives:[{name:"show",rawName:"v-show",value:e.del,expression:"del"}],staticClass:"del",on:{click:function(a){e.queren(t)}}},[e._v("X")])])}))},staticRenderFns:[]};var h={components:{topNav:o,sixItem:a("VU/8")(c,d,!1,function(e){a("KFn4")},"data-v-975a5642",null).exports,breadNav:a("hWqa").a},data:function(){return{currentNodeKey:"1",activeTreeId:"",hasData:!1,addShow:!1,deleteShow:!1,textChange1:!1,edit1:!1,edit2:!1,defaultProps:{children:"child",label:"mechanism_name"},treeData:[],jigoulist:[],active_yema:"0",add_name:"",activeHandTreeData:"",add_fujigou:"0-0",add_bianhao:"",add_miaoshu:"",changeData:"",treeStr:"",pageTotal:null,changeJiGou:{jiGouName:"",jiGouBianHao:""},selValue:"",putValue:"",sync:0}},methods:{handleNodeClick:function(e){this.$refs.page.internalCurrentPage=1,this.currentNodeKey=e.id,this.activeHandTreeData=e,this.handClick(e.id)},subSearch:function(){this.selValue?this.putValue?this.jigouSearch(1,this.putValue):this.$message({message:"请输入您要搜索的内容",type:"warning"}):this.$message({message:"请选择搜索条件",type:"warning"})},jigouSearch:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i={p:t,ps:"60",mechanism_id:this.activeHandTreeData.mechanism_id||this.treeData[0].mechanism_id},s=this.$gscookie.getCookie("gun"),n=this.selValue;i[n]=a;var o=this.$store.state.key,c=this.$methods.mkSign(i,o),d=new URLSearchParams;d.append("p",i.p),d.append("ps",i.ps),d.append(n,i[n]),d.append("mechanism_id",i.mechanism_id),d.append("sign",c),d.append("token",s),this.$axios({url:this.$store.state.baseURL+"/weixin/project/index.php?m=home&c=mechanism&a=mechanisms",method:"POST",changeOrigin:!0,data:d}).then(function(t){200==t.data.code&&0!=t.data.data.length&&(e.jigoulist=t.data.data.list),e.putValue="",e.pageTotal=null}).catch(function(e){console.log(e)})},currentChange:function(e){this.deleteShow=!1,this.active_yema=e,this.handClick(this.currentNodeKey,e)},addData:function(){var e=this,t=this.add_fujigou.split("-"),a=this.$store.state.key,i={mechanism_name:this.add_name,pid:t[0],root_id:t[1],code:this.add_bianhao,mechanism_desc:this.add_miaoshu},s=this.$methods.mkSign(i,a),n=this.$gscookie.getCookie("gun"),o=new URLSearchParams;o.append("mechanism_name",i.mechanism_name),o.append("root_id",i.root_id),o.append("pid",i.pid),o.append("code",i.code),o.append("mechanism_desc",i.mechanism_desc),o.append("sign",s),o.append("token",n),this.$axios({url:this.$store.state.baseURL+"/weixin/project/index.php?m=home&c=mechanism&a=rewrite",method:"POST",changeOrigin:!0,data:o}).then(function(t){200==t.data.code&&(e.$message("添加机构成功"),e.addShow=!1,e.getTreeData(),e.handClick(e.currentNodeKey,e.active_yema))}).catch(function(e){console.log(e)})},removeData:function(e){var t=this,a=this.$gscookie.getCookie("gun"),i={mechanism_id:e.item.id},s=this.$store.state.key,n=this.$methods.mkSign(i,s),o=new URLSearchParams;o.append("mechanism_id",i.mechanism_id),o.append("sign",n),o.append("token",a),this.$axios({url:this.$store.state.baseURL+"/weixin/project/index.php?m=home&c=mechanism&a=del",method:"POST",changeOrigin:!0,data:o}).then(function(a){if(200==a.data.code){t.$message("已经删除");var i=t.jigoulist.findIndex(function(t){return t.id==e.item.id});t.jigoulist.splice(i,1)}else 402==a.data.code&&t.$message({message:a.data.msg,type:"warning"})}).catch(function(e){console.log(e)})},modifyData:function(){var e=this,t=this.$gscookie.getCookie("gun"),a={mechanism_name:this.changeData.mechanism_name,pid:this.changeData.pid,Root_id:this.changeData.root_id,id:this.changeData.id,code:this.changeData.code,mechanism_desc:this.changeData.mechanism_desc},i=this.$store.state.key,s=this.$methods.mkSign(a,i),n=new URLSearchParams;n.append("mechanism_name",a.mechanism_name),n.append("pid",a.pid),n.append("Root_id",a.Root_id),n.append("id",a.id),n.append("code",a.code),n.append("mechanism_desc",a.mechanism_desc),n.append("sign",s),n.append("token",t),this.$axios({url:this.$store.state.baseURL+"/weixin/project/index.php?m=home&c=mechanism&a=rewrite",method:"POST",changeOrigin:!0,data:n}).then(function(t){200==t.data.code&&e.$message("修改数据成功")}).catch(function(e){console.log(e)})},submitadd:function(){""!=this.add_name.trim()?""!=this.add_bianhao.trim()?""!=this.add_fujigou?""!=this.add_miaoshu.trim()?(this.addData(),this.add_name="",this.add_fujigou="",this.add_bianhao="",this.add_miaoshu="",this.addShow=!1):this.$message({message:"请填写机构描述",type:"warning"}):this.$message({message:"请选择机构",type:"warning"}):this.$message({message:"请设置机构编号",type:"warning"}):this.$message({message:"名字不能为空",type:"warning"})},addjigou:function(){this.addShow=!0},quxiao:function(){this.addShow=!1},shanchujigou:function(){this.deleteShow=!0},yijingchanchu:function(e){this.deleteShow=!1,this.removeData(e),this.getTreeData()},changeOneData:function(e){this.textChange1=!0,this.changeData=e},textSubmit:function(){this.textChange1=!1,this.modifyData()},quxiaoxiugai:function(){this.textChange1=!1},changeText:function(e){var t=this,a=this.mesArr.findIndex(function(t){return t==e});this.mesArr.forEach(function(t){t==e&&(e.edit=!e.edit)}),this.$nextTick(function(){t.$refs.puts[a].focus()})},putBlur:function(e){this.mesArr.forEach(function(t){t==e&&(t.edit=!t.edit)})},handClick:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(this.deleteShow=!1,e){var i=this.$gscookie.getCookie("gun"),s={p:a,ps:"6",mechanism_id:e},n=this.$store.state.key,o=this.$methods.mkSign(s,n),c=new URLSearchParams;c.append("p",s.p),c.append("ps",s.ps),c.append("mechanism_id",s.mechanism_id),c.append("sign",o),c.append("token",i),this.$axios({url:this.$store.state.baseURL+"/weixin/project/index.php?m=home&c=mechanism&a=mechanisms",method:"POST",changeOrigin:!0,data:c}).then(function(e){t.jigoulist=e.data.data.list,t.pageTotal=e.data.data.psum-0}).catch(function(e){console.log(e)})}},changeText1:function(){var e=this;this.edit1=!0,this.$nextTick(function(){e.$refs.put1.focus()})},changeText2:function(){var e=this;this.edit2=!0,this.$nextTick(function(){e.$refs.put2.focus()})},getTreeData:function(){var e=this,t=this.$store.state.key,a={p:1,ps:10,mechanism_id:1},i=this.$methods.mkSign(a,t),s=this.$gscookie.getCookie("gun"),n=new URLSearchParams;n.append("p",a.p),n.append("ps",a.ps),n.append("mechanism_id",a.mechanism_id),n.append("sign",i),n.append("token",s),this.$axios({url:this.$store.state.baseURL+"/weixin/project/index.php?m=home&c=mechanism&a=mechanisms_tree",method:"POST",changeOrigin:!0,data:n}).then(function(t){e.treeData=t.data.data.list,e.handClick(e.treeData[0].id),e.treeStr=function e(t){var a="";if(t.length>0)for(var i=0;i<t.length;i++)a+='<option value="'+t[i].id+"-"+t[i].root_id+'" > '+t[i].mechanism_name+"</option>",t[i].child.length>0&&(a+=e(t[i].child));return a}(t.data.data.list),e.$store.state.jigouTreeStr=e.treeStr}).catch(function(e){console.log(e)}),this.hasData=!0}},created:function(){this.sync=this.$gscookie.getCookie("sync"),this.currentNodeKey=this.$gscookie.getCookie("mechanism_id"),this.handClick(this.currentNodeKey),3==this.$gscookie.getCookie("message_obj").role_id&&this.$router.push({name:"GuiJi"});var e=this.$gscookie.getCookie("gun");"{}"==s()(e)&&this.$router.push("/loginput"),this.getTreeData()},mounted:function(){var e=this,t=this;this.$nextTick(function(){e.$refs.con.addEventListener("click",function(e){"close"!=e.target.className&&(t.deleteShow=!1)})})}},r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.hasData?a("div",{staticClass:"jigou"},[a("div",{staticClass:"tree-menu"},[a("h3",[e._v("机构管理")]),e._v(" "),a("div",{staticClass:"nav-wrap"},[a("el-tree",{attrs:{data:e.treeData,props:e.defaultProps,accordion:"","highlight-current":!0,"node-key":"id","current-node-key":e.currentNodeKey,"default-expand-all":""},on:{"node-click":e.handleNodeClick}})],1)]),e._v(" "),a("div",{staticClass:"top-nav"},[a("div",{staticClass:"bread-wrap"},[a("breadNav",{attrs:{title:"机构管理",next:e.activeHandTreeData.mechanism_name}})],1),e._v(" "),a("div",{staticClass:"search-wrap"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.selValue,expression:"selValue"}],staticClass:"sel",on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.selValue=t.target.multiple?a:a[0]}}},[a("option",{attrs:{value:"",disabled:"",selected:""}},[e._v("请选择搜索类型")]),e._v(" "),a("option",{attrs:{value:"mechanism_name"}},[e._v("机构名称")]),e._v(" "),a("option",{attrs:{value:"code"}},[e._v("机构编号")])]),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.putValue,expression:"putValue",modifiers:{trim:!0}}],staticClass:"textput",attrs:{type:"text",placeholder:"请输入搜索关键字"},domProps:{value:e.putValue},on:{keyup:function(t){return"button"in t||13===t.keyCode?e.subSearch(t):null},input:function(t){t.target.composing||(e.putValue=t.target.value.trim())},blur:function(t){e.$forceUpdate()}}}),e._v(" "),a("button",{staticClass:"sub",on:{click:e.subSearch}})])]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.pageTotal,expression:"pageTotal"}],staticClass:"page-index"},[a("el-pagination",{ref:"page",attrs:{"page-size":6,"pager-count":9,layout:"prev, pager, next",total:e.pageTotal},on:{"current-change":e.currentChange}})],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"message-box"},[a("p",[e._v("当前显示 *** "+e._s(e.activeHandTreeData.mechanism_name)+" *** 下的机构信息")])]),e._v(" "),1!=e.sync?a("div",{directives:[{name:"show",rawName:"v-show",value:e.activeHandTreeData,expression:"activeHandTreeData"}],staticClass:"add-del"},[a("button",{on:{click:e.addjigou}},[e._v("新增机构")]),e._v(" "),a("button",{on:{click:e.shanchujigou}},[e._v("删除机构")])]):e._e(),e._v(" "),a("div",{ref:"con",staticClass:"content"},[a("sixItem",{attrs:{del:e.deleteShow,dataList:e.jigoulist,dataLength:e.jigoulist.length,sync:e.sync},on:{deleted:e.yijingchanchu,changeOneData:e.changeOneData}})],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.addShow,expression:"addShow"}],staticClass:"alert"},[a("div",{staticClass:"text-wrap"},[a("div",{staticClass:"text-title"},[e._v("新增机构")]),e._v(" "),a("div",{staticClass:"text"},[a("div",[a("p",[e._v("机构名称")]),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.add_name,expression:"add_name"}],attrs:{type:"text"},domProps:{value:e.add_name},on:{input:function(t){t.target.composing||(e.add_name=t.target.value)}}})]),e._v(" "),a("div",[a("p",[e._v("父机构")]),e._v(" "),a("select",{directives:[{name:"model",rawName:"v-model",value:e.add_fujigou,expression:"add_fujigou"}],attrs:{id:"selput"},domProps:{innerHTML:e._s(e.treeStr)},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.add_fujigou=t.target.multiple?a:a[0]}}})]),e._v(" "),a("div",[a("p",[e._v("机构编号")]),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.add_bianhao,expression:"add_bianhao"}],attrs:{type:"text"},domProps:{value:e.add_bianhao},on:{input:function(t){t.target.composing||(e.add_bianhao=t.target.value)}}})]),e._v(" "),a("div",[a("p",[e._v("机构描述")]),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.add_miaoshu,expression:"add_miaoshu"}],attrs:{type:"text"},domProps:{value:e.add_miaoshu},on:{input:function(t){t.target.composing||(e.add_miaoshu=t.target.value)}}})])]),e._v(" "),a("div",{staticClass:"submit",on:{click:e.submitadd}},[e._v("确认")]),e._v(" "),a("div",{staticClass:"quxiao",on:{click:e.quxiao}})])]),e._v(" "),e.changeData?a("div",{directives:[{name:"show",rawName:"v-show",value:e.textChange1,expression:"textChange1"}],staticClass:"change"},[a("div",{staticClass:"dataitem",class:{checked:e.edit1}},[a("h5",[e._v("机构名称：")]),e._v(" "),a("div",{staticClass:"put-wrap"},[a("span",[e._v(e._s(e.changeData.mechanism_name))]),e._v(" "),a("i",{on:{click:e.changeText1}}),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.changeData.mechanism_name,expression:"changeData.mechanism_name"}],ref:"put1",attrs:{type:"text"},domProps:{value:e.changeData.mechanism_name},on:{blur:function(t){e.edit1=!1},input:function(t){t.target.composing||e.$set(e.changeData,"mechanism_name",t.target.value)}}})])]),e._v(" "),a("div",{staticClass:"dataitem",class:{checked:e.edit2}},[a("h5",[e._v("机构编号：")]),e._v(" "),a("div",{staticClass:"put-wrap"},[a("span",[e._v(e._s(e.changeData.code))]),e._v(" "),a("i",{on:{click:e.changeText2}}),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.changeData.code,expression:"changeData.code"}],ref:"put2",attrs:{type:"text"},domProps:{value:e.changeData.code},on:{blur:function(t){e.edit2=!1},input:function(t){t.target.composing||e.$set(e.changeData,"code",t.target.value)}}})])]),e._v(" "),a("button",{on:{click:e.textSubmit}},[e._v("确定")]),e._v(" "),a("button",{on:{click:e.quxiaoxiugai}},[e._v("取消")])]):e._e(),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.textChange1||e.addShow,expression:"textChange1||addShow"}],staticClass:"cover"})]):e._e()},staticRenderFns:[]};var u=a("VU/8")(h,r,!1,function(e){a("mG0n")},"data-v-75494240",null);t.default=u.exports},mG0n:function(e,t){}});
//# sourceMappingURL=8.d2ab1bddbd9c395da62b.js.map