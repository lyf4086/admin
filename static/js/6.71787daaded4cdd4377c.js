webpackJsonp([6],{"72E/":function(t,e,s){"use strict";(function(t){var i=s("mvHQ"),a=s.n(i),n=s("Dd8w"),c=s.n(n),o=s("hWqa"),r=s("pXjI"),l=s("3Cqg"),h=s("LdhR");e.a={components:{breadNav:o.a,Item:r.a,GaoDeMap:h.a,MapMarker:l.a},data:function(){return{currentNodeKey:"",rootId:"",treeListData:[],activeItem:"",activeMechanismId:"",defaultProps:{children:"child",label:"mechanism_name"},active_title:"",message:"",selValue:"",putValue:"",state:"",dataTotal:0,activeYeMa:0,search:!1,checkType:!0,beiYongList:[],list:[],rewriteAll:!1,textArea:"",txt:"",currentPage:3,policeuser_id:"",gaodeshow:!1,gaodeArr:[116.397428,39.90923]}},methods:{chulihuidiao:function(){var t=this.activeYeMa||1;this.getDataList(this.activeItem.mechanism_id,t,8)},showNew:function(t){this.gaodeArr=[t[0]-0,t[1]-0],this.gaodeshow=!0},closeMap:function(){this.gaodeshow=!1},showAlert:function(t){console.log(t),this.gaodeArr=[t[0]-0,t[1]-0],this.gaodeshow=!0},currentChange:function(t){this.search&&this.getDataList(this.activeMechanismId,t,8,this.selValue,this.putValue,this.state),this.activeYeMa=t,this.message="",this.getDataList(this.activeMechanismId,t,8,this.selValue,this.putValue,this.state)},outIn:function(){this.checkType?t(".check_type").animate({right:"-1.8rem"},function(){t(".goback").animate({right:"1.48rem"}),t(".ii").css("transform","rotateY(180deg)")}):t(".goback").animate({right:"0"},function(){t(".check_type").animate({right:"-0.33rem"}),t(".ii").css("transform","rotateY(0deg)")}),this.checkType=!this.checkType},changeOneData:function(t){this.list[t].checked=!this.list[t].checked},dealAll:function(){this.list.some(function(t){return t.checked})?this.rewriteAll=!0:this.$message("请先选择要处理的项目")},quxiao:function(){this.rewriteAll=!1,this.textArea=""},noDeal:function(){this.message="",this.state=1,this.getDataList(this.activeItem.mechanism_id,1,8,this.selValue,this.putValue,this.state)},dealed:function(){this.message="",this.state=2,this.getDataList(this.activeItem.mechanism_id,1,8,this.selValue,this.putValue,this.state)},subRewrite:function(){if(this.message="",""!=this.txt.trim()&&""!=this.textArea.trim()){this.rewriteAll=!1;var t=this.list.filter(function(t){return t.checked}).map(function(t){return t.alarm_info_id});this.chuLi(t,this.txt,this.textArea),this.textArea=""}else this.$message("请输入您的标题和处理意见")},quanbu:function(){this.message="",this.state="",this.getDataList(this.activeItem.mechanism_id,1,8)},getTreeList:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],s=this.$gscookie.getCookie("mechanism_id"),i=this.$store.state.key,a={p:1,ps:6,mechanism_id:s},n=this.$methods.mkSign(a,i),c=this.$gscookie.getCookie("gun"),o=new URLSearchParams;o.append("p",a.p),o.append("ps",a.ps),o.append("mechanism_id",a.mechanism_id),o.append("sign",n),o.append("token",c),this.$axios({url:this.$store.state.baseURL+"/weixin/project/index.php?m=home&c=mechanism&a=mechanisms_tree",method:"POST",changeOrigin:!0,data:o}).then(function(s){t.treeListData=s.data.data.list,t.rootId=s.data.data.list[0].root_id,t.activeItem=s.data.data.list[0],e&&t.getDataList(t.activeItem.id,1,8)}).catch(function(t){console.log(t)}),this.hasData=!0},getDataList:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,i=arguments[3],a=this,n=arguments[4],o=arguments[5];t||(t=this.$gscookie.getCookie("mechanism_id"));var r=this.$store.state.key,l={p:e,ps:s,mechanism_id:t};i&&(l[i]=n),o&&(l.state=o);var h=this.$methods.mkSign(l,r),d=this.$gscookie.getCookie("gun"),u=new URLSearchParams;u.append("p",l.p),u.append("ps",l.ps),u.append("mechanism_id",l.mechanism_id),i&&u.append(i,n),o&&u.append("state",l.state),u.append("sign",h),u.append("token",d),this.$axios({url:this.$store.state.baseURL+"/weixin/project/index.php?m=home&c=alarm&a=alarms",method:"POST",changeOrigin:!0,data:u}).then(function(t){200==t.data.code&&(a.list=t.data.data.list.map(function(t,e){return c()({},t,{checked:!1,index:e})}),a.beiYongList=a.list,a.dataTotal=1*t.data.data.psum)}).catch(function(t){console.log(t)})},chuLi:function(t,e){var s=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=this.$store.state.key,n={alarm_info_ids:t.join(","),desc:e,content:i,policeuser_id:this.policeuser_id},c=this.$methods.mkSign(n,a),o=this.$gscookie.getCookie("gun"),r=new URLSearchParams;r.append("alarm_info_ids",n.alarm_info_ids),r.append("desc",n.desc),r.append("content",n.content),r.append("sign",c),r.append("token",o),r.append("policeuser_id",n.policeuser_id),this.$axios({url:this.$store.state.baseURL+"/weixin/project/index.php?m=home&c=alarm&a=alarm_processing",method:"POST",changeOrigin:!0,data:r}).then(function(t){if(200==t.data.code){s.$message({type:"success",message:"处理完成"});var e=s.activeYeMa||1;s.getDataList(s.activeItem.mechanism_id,e,8)}}).catch(function(t){console.log(t)}),this.hasData=!0},handleNodeClick:function(t){this.list.length&&(this.$refs.page.internalCurrentPage=1),this.activeMechanismId=t.mechanism_id,this.message="",this.search=!1,this.state="",this.selValue="",this.putValue="",this.active_title=t.mechanism_name,this.activeItem=t,this.getDataList(t.mechanism_id,1,8)},subSearch:function(){this.selValue||this.$message({type:"warning",message:"请先选择搜索类型"}),this.putValue||this.$message({type:"warning",message:"请输入搜索关键字"}),this.serach=!0,this.message=this.putValue,this.list.length&&(this.$refs.page.internalCurrentPage=1),this.getDataList(this.activeMechanismId,1,8,this.selValue,this.putValue,this.state)}},created:function(){this.currentNodeKey=this.$gscookie.getCookie("mechanism_id");var t=this.$route.params,e=this.$gscookie.getCookie("gun"),s=this.$gscookie.getCookie("message_obj");if(this.policeuser_id=s.id,3==s.role_id&&this.$router.push({name:"GuiJi"}),"{}"!=a()(e))return t.one?(this.getTreeList(!1),void this.getDataList(t.org_id||t.mechanism_id,1,8,"policeuser_name",t.policeName||t.policeuser_name,1)):void(t.mechanism_id?(this.search=!0,this.activeMechanismId=t.mechanism_id,this.state="",this.selValue="policeuser_name",this.putValue=t.policeuser_name,this.currentNodeKey=t.mechanism_id,this.getTreeList(!1),this.subSearch()):this.getTreeList());this.$router.push("/loginput")},watch:{}}}).call(e,s("7t+N"))},I5rY:function(t,e){},LdhR:function(t,e,s){"use strict";var i=s("Gu7T"),a=s.n(i),n={props:["arr","title"],data:function(){return{BM:null,map:null}},methods:{closeMap:function(){this.$emit("closeMap")},mapInit:function(t){var e=this.arr[0]>this.arr[1]?[this.arr[0],this.arr[1]]:[this.arr[1],this.arr[0]],s=new AMap.Map("map",{center:e,resizeEnable:!0,zoom:13});this.map=s,this.setMarker(e)},setMarker:function(t){var e=t||[116.397428,39.90923],s=new AMap.Marker({position:new(Function.prototype.bind.apply(AMap.LngLat,[null].concat(a()(e)))),title:this.title});this.map.add(s),this.map.setFitView([].concat(a()(s)))}},mounted:function(){this.mapInit()}},c={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"wrap"},[e("div",{staticClass:"map_wrap"},[e("div",{attrs:{id:"map"}}),this._v(" "),e("button",{staticClass:"close",on:{click:this.closeMap}},[this._v("取消")]),this._v(" "),e("div",{staticClass:"del",on:{click:this.closeMap}},[this._v("X")])])])},staticRenderFns:[]};var o=s("VU/8")(n,c,!1,function(t){s("Peo6")},"data-v-257fa722",null);e.a=o.exports},Peo6:function(t,e){},"od/z":function(t,e){},pXjI:function(t,e,s){"use strict";var i={props:{item:{type:Object,default:function(){return{}}}},data:function(){return{showmap:!1,xiangqing:!1,message:null,titleStr:"",textarea:""}},computed:{chuli:function(){return this.item.desc?"yes":"not"},text:function(){return this.item.desc?"已处理":"未处理"}},methods:{kaishichuli:function(){if(this.titleStr.trim()&&this.textarea.trim()){var t=[this.message.id],e=this.titleStr,s=this.textarea;this.chuLi(t,e,s)}else this.$message({type:"error",message:"请输入完整"})},closeXiangqing:function(){this.xiangqing=!1},showMore:function(t){this.getXiangqing(t.alarm_info_id)},showNew:function(t){this.$emit("showNew",t)},showAlert:function(t){console.log(t),t[0]||t[1]?this.$emit("showAlert",t):this.$message({type:"warning",message:"暂无"})},changeOne:function(t){this.$emit("changeOneData",t)},gunCode:function(t){return 1==t?"92式":2==t?"95式":3==t?"77式":4==t?"64式":5==t?"92改":void 0},chuLi:function(t,e){var s=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=this.$store.state.key,n={alarm_info_ids:t.join(","),desc:e,content:i,policeuser_id:this.policeuser_id},c=this.$methods.mkSign(n,a),o=this.$gscookie.getCookie("gun"),r=new URLSearchParams;r.append("alarm_info_ids",n.alarm_info_ids),r.append("desc",n.desc),r.append("content",n.content),r.append("sign",c),r.append("token",o),r.append("policeuser_id",n.policeuser_id),this.$axios({url:this.$store.state.baseURL+"/weixin/project/index.php?m=home&c=alarm&a=alarm_processing",method:"POST",changeOrigin:!0,data:r}).then(function(t){200==t.data.code&&(s.$message({type:"success",message:"处理完成"}),s.xiangqing=!1,s.$emit("chulihuidiao"))}).catch(function(t){console.log(t)}),this.hasData=!0},changeTime:function(t){var e=new Date(1e3*t);return e.getFullYear()+"-"+((e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1)+"-")+(e.getDate()+" ")+(e.getHours()+":")+(e.getMinutes()+":")+e.getSeconds()},getXiangqing:function(t){var e=this,s=this.$store.state.key,i={alarm_info_id:t},a=this.$methods.mkSign(i,s),n=this.$gscookie.getCookie("gun"),c=new URLSearchParams;c.append("alarm_info_id",i.alarm_info_id),c.append("sign",a),c.append("token",n),this.$axios({url:this.$store.state.baseURL+"/weixin/project/index.php?m=Home&c=alarm&a=info",method:"POST",changeOrigin:!0,data:c}).then(function(t){200==t.status&&(e.xiangqing=!0,e.message=t.data,console.log(e.message))}).catch(function(t){console.log(t)})}},mounted:function(){this.showmap=!0}},a={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.item.created?s("div",{staticClass:"item-main"},[s("div",{staticClass:"title",staticStyle:{color:"#ffffff"}},[t._m(0),t._v(" "),s("div",{staticClass:"name"},[s("p",[t._v("\n        "+t._s(t.item.policeuser.policeuser_name)+"\n        "),s("i",{attrs:{title:t.item.policeuser.police_number}},[t._v(t._s(t.item.policeuser.police_number))])]),t._v(" "),s("p",{staticClass:"time"},[t._v(t._s(t.changeTime(t.item.created)))])])]),t._v(" "),s("div",{staticClass:"content"},[s("div",{staticClass:"tex_wrap"},[s("div",{staticClass:"list"},[s("span",[t._v("报警类型：")]),t._v(" "),s("span",[t._v(t._s(t.item.type))])]),t._v(" "),s("div",{staticClass:"list"},[s("span",[t._v("处理人：")]),t._v(" "),s("span",[t._v(t._s(t.item.uname||"暂无"))])]),t._v(" "),s("div",{staticClass:"list"},[s("span",[t._v("枪支编号：")]),t._v(" "),s("span",[t._v(t._s(t.item.gun.gun_code))])]),t._v(" "),s("div",{staticClass:"list"},[s("span",[t._v("枪支类型：")]),t._v(" "),s("span",[t._v(t._s(t.item.gun.gtype))])]),t._v(" "),t._e(),t._v(" "),t._e(),t._v(" "),s("div",{staticClass:"list"},[s("span",[t._v("是否处理：")]),t._v(" "),s("span",{class:t.chuli},[s("i"),t._v("\n          "+t._s(t.text)+"\n        ")])]),t._v(" "),s("div",{staticClass:"list btnwrap"},[s("button",{staticClass:"btn1",on:{click:function(e){t.showNew([t.item.nlongitude,t.item.nlatitude])}}},[t._v("最新位置")]),t._v(" "),s("button",{staticClass:"btn2",on:{click:function(e){t.showAlert([t.item.lon,t.item.lat])}}},[t._v("报警位置")]),t._v(" "),s("button",{staticClass:"btn3",on:{click:function(e){t.showMore(t.item)}}},[t._v("详情")])])]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:!t.item.desc&&"08"!=t.item.types,expression:"!item.desc && item.types!='08'"}],staticClass:"sel",class:{selected:t.item.checked},on:{click:function(e){t.changeOne(t.item.index)}}})]),t._v(" "),t.xiangqing?s("div",{staticClass:"cover"},[t.message.IMEI?s("div",{staticClass:"alert"},[s("button",{staticClass:"close",on:{click:t.closeXiangqing}},[t._v("取消")]),t._v(" "),s("div",{staticClass:"del",on:{click:t.closeXiangqing}},[t._v("X")]),t._v(" "),s("button",{directives:[{name:"show",rawName:"v-show",value:"无"==t.message.desc,expression:"message.desc=='无'"}],staticClass:"chuli",on:{click:t.kaishichuli}},[t._v("处理")]),t._v(" "),s("div",{staticClass:"txt"},[s("div",{staticClass:"text"},[t._v(t._s(t.message.mname))]),t._v(" "),s("div",{staticClass:"text imei"},[t._v(t._s(t.message.IMEI))]),t._v(" "),s("div",{staticClass:"text"},[t._v(t._s(t.message.policeuser_name))]),t._v(" "),s("div",{staticClass:"text"},[t._v(t._s(t.message.mobile))]),t._v(" "),s("div",{staticClass:"text"},[t._v(t._s(t.message.gun_code))]),t._v(" "),s("div",{staticClass:"text"},[t._v(t._s(t.message.gtype))]),t._v(" "),s("div",{staticClass:"text"},[t._v(t._s(t.message.police_number))]),t._v(" "),s("div",{staticClass:"text"},[t._v(t._s(t.message.type))]),t._v(" "),s("div",{staticClass:"text"},[t._v(t._s(t.message.created))]),t._v(" "),s("div",{staticClass:"text",class:"无"==t.message.desc?" red":" green"},[t._v(t._s("无"==t.message.desc?"未处理":"已处理"))]),t._v(" "),s("div",{staticClass:"yijian"},["极速处理"==t.message.desc||"无"!=t.message.desc?s("p",{staticClass:"tit"},[t._v(t._s(t.message.desc))]):t._e(),t._v(" "),"无"==t.message.desc?s("input",{directives:[{name:"model",rawName:"v-model",value:t.titleStr,expression:"titleStr"}],attrs:{type:"text",placeholder:"请输入处理标题"},domProps:{value:t.titleStr},on:{input:function(e){e.target.composing||(t.titleStr=e.target.value)}}}):t._e()]),t._v(" "),s("div",{staticClass:"biaoti"},[t.item.content?s("p",[t._v(t._s(t.message.content))]):t._e(),t._v(" "),"无"==t.message.desc?s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.textarea,expression:"textarea"}],attrs:{placeholder:"请输入处理意见",cols:"24",rows:"2"},domProps:{value:t.textarea},on:{input:function(e){e.target.composing||(t.textarea=e.target.value)}}}):t._e()])])]):t._e()]):t._e()]):t._e()},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"round_wrap"},[e("div",{staticClass:"round"}),this._v(" "),e("div",{staticClass:"gun"})])}]};var n=s("VU/8")(i,a,!1,function(t){s("od/z")},"data-v-77826b15",null);e.a=n.exports},srKt:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s("72E/"),a={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"jigou"},[s("div",{staticClass:"tree-menu"},[s("h3",[t._v("报警管理")]),t._v(" "),s("div",{staticClass:"nav-wrap"},[s("el-tree",{attrs:{data:t.treeListData,props:t.defaultProps,"highlight-current":!0,accordion:"","node-key":"id","current-node-key":t.currentNodeKey,"default-expand-all":""},on:{"node-click":t.handleNodeClick}})],1)]),t._v(" "),s("div",{staticClass:"top-nav"},[s("div",{staticClass:"bread-wrap"},[s("breadNav",{attrs:{title:"报警管理",next:t.active_title,message:t.message}})],1),t._v(" "),s("div",{staticClass:"search-wrap"},[s("select",{directives:[{name:"model",rawName:"v-model",value:t.selValue,expression:"selValue"}],staticClass:"sel",on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.selValue=e.target.multiple?s:s[0]}}},[s("option",{attrs:{value:"",disabled:"",selected:""}},[t._v("请选择搜索类型")]),t._v(" "),s("option",{attrs:{value:"policeuser_name"}},[t._v("警员名称")]),t._v(" "),s("option",{attrs:{value:"gun_code"}},[t._v("枪支编号")])]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.putValue,expression:"putValue"}],staticClass:"textput",attrs:{type:"text",placeholder:"请输入搜素关键字"},domProps:{value:t.putValue},on:{keyup:function(e){return"button"in e||13===e.keyCode?t.subSearch(e):null},input:function(e){e.target.composing||(t.putValue=e.target.value)}}}),t._v(" "),s("button",{staticClass:"sub",on:{click:t.subSearch}})])]),t._v(" "),s("div",{staticClass:"page-index"},[s("el-pagination",{ref:"page",attrs:{"page-size":8,"pager-count":9,layout:"prev, pager, next",total:t.dataTotal},on:{"current-change":t.currentChange}})],1),t._v(" "),s("div",{staticClass:"content"},[t.list.length?t._e():s("div",{staticClass:"none-data"},[t._v("暂时没有数据......")]),t._v(" "),t._l(t.list,function(e,i){return s("Item",{key:i,attrs:{item:e},on:{changeOneData:t.changeOneData,showNew:t.showNew,showAlert:t.showAlert,chulihuidiao:t.chulihuidiao}})})],2),t._v(" "),s("div",{staticClass:"check_type"},[s("div",{staticClass:"all",on:{click:t.dealAll}},[s("span"),t._v("\n      一键处理\n    ")]),t._v(" "),s("div",{staticClass:"no",on:{click:t.noDeal}},[s("span"),t._v("\n      未处理\n    ")]),t._v(" "),s("div",{staticClass:"yes",on:{click:t.dealed}},[s("span"),t._v("\n      已处理\n    ")]),t._v(" "),s("div",[s("span",{staticClass:"quanbu",on:{click:t.quanbu}},[t._v("全部")])]),t._v(" "),s("button",{staticClass:"goback",on:{click:t.outIn}},[s("i",{staticClass:"ii"})])]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.rewriteAll,expression:"rewriteAll"}],staticClass:"cover"},[s("div",{staticClass:"rewrite"},[s("span",[t._v("处理标题：")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.txt,expression:"txt"}],staticClass:"put",attrs:{type:"text"},domProps:{value:t.txt},on:{input:function(e){e.target.composing||(t.txt=e.target.value)}}}),t._v(" "),s("span",[t._v("处理意见：")]),t._v(" "),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.textArea,expression:"textArea"}],staticClass:"text",attrs:{placeholder:"请输入您的处理意见"},domProps:{value:t.textArea},on:{input:function(e){e.target.composing||(t.textArea=e.target.value)}}}),t._v(" "),s("button",{on:{click:t.subRewrite}},[t._v("确定")]),t._v(" "),s("i"),t._v(" "),s("p",{on:{click:t.quxiao}},[t._v("X")])])]),t._v(" "),t.gaodeshow?s("GaoDeMap",{attrs:{arr:t.gaodeArr,title:"aaa"},on:{closeMap:t.closeMap}}):t._e()],1)},staticRenderFns:[]};var n=function(t){s("I5rY")},c=s("VU/8")(i.a,a,!1,n,"data-v-003dee90",null);e.default=c.exports}});
//# sourceMappingURL=6.71787daaded4cdd4377c.js.map