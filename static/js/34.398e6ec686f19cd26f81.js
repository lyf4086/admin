webpackJsonp([34],{QLhq:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("mvHQ"),s=i.n(a),n=i("Dd8w"),o=i.n(n),r=i("162o"),c={data:function(){return{steap:1,dbtimestart:"",dbtimeend:"",dbwarningtype:[{id:"03",name:"入套报警",checked:!1},{id:"07",name:"区域报警",checked:!1},{id:"08",name:"逾期报警",checked:!1},{id:"09",name:"离套报警",checked:!1}],selectedType:"",dbjigoulist:[],dbselectedjigou:"",dbtext:"",dbnames:["111","222"],dbx:["06:00","07:00","23:55"],dblist:[],showFenXi:!1,bigsmall:!0,echar1_names:[],echar_date:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],echar_num:[820,932,901,934,1290,1330,1320],list:[],selected:[],dataList:[],obj:null,rightData1:[],rightData2:[],timeStart:"",timeEnd:"",warningType:[{id:"03",name:"入套报警",checked:!0},{id:"07",name:"区域报警",checked:!0},{id:"08",name:"逾期报警",checked:!0},{id:"09",name:"离套报警",checked:!0}],jigoulist:[],series:{"03":[],"07":[],"08":[],"09":[]}}},methods:{dbchecktype:function(t){this.dbwarningtype.forEach(function(e,i){e.checked=i===t})},dbjigoucheck:function(t){this.dbjigoulist[t].checked=!this.dbjigoulist[t].checked},next1:function(){this.dbtimestart&&this.dbtimeend?this.steap=2:this.$message({type:"warning",message:"请选择起止时间"})},next2:function(){var t=this.dbwarningtype.find(function(t){return t.checked});t?(this.selectedType=t.id,this.steap=3):this.$message({type:"warning",message:"请选择类型"})},next3:function(){var t=this.dbjigoulist.filter(function(t){return t.checked});if(t.length>0){this.steap=4;var e=t[0].ip_id,i=t.map(function(t){return t.id}).join(),a=this.dbtimestart+","+this.dbtimeend;this.getDuiBi(i,e,this.selectedType,a)}else this.$message({type:"warning",message:"请选择机构"})},next4:function(){this.dbtimestart="",this.dbtimeend="",this.dbwarningtype.forEach(function(t){return t.checked=!1}),this.dbjigoulist.forEach(function(t){return t.checked=!1}),this.steap=1,this.showFenXi=!1},subDuiBi:function(){this.getDuiBi(32,1,"03,09,07,08","2019-08-16,2019-08-22")},close:function(){this.steap=1,this.showFenXi=!1,this.next4()},fenxi:function(){this.showFenXi=!0},upDown:function(){this.bigsmall=!this.bigsmall},toMore:function(t,e,i){var a=this.warningType.filter(function(t){return t.checked}).map(function(t){return t.id}).join();0!=t?this.$router.push({name:"XiangQingList",params:o()({},i,{types:a,timeStart:this.timeStart,timeEnd:this.timeEnd})}):this.$message("暂无数据")},duiBiEchart:function(){var t=this,e=document.getElementById("dbchart"),i=this.$echarts.init(e,!0),a={name:"111",data:[.3,.9,.7,.9,.8,.3],type:"line",smooth:!0,areaStyle:{opacity:0},itemStyle:{normal:{color:"#197CD8",lineStyle:{color:"#197CD8"}}}},s=this.dblist.map(function(e,i){return o()({},a,{name:t.dbnames[i],data:e})}),n={postion:"200",title:{text:"",x:"center",y:"-5",textStyle:{fontSize:16,color:"#fff"}},legend:{icon:"line",top:20,textStyle:{color:"#fff",data:this.dbnames},itemWidth:10,itemHeight:10},tooltip:{trigger:"axis"},xAxis:{type:"category",boundaryGap:!1,data:this.dbx,axisLabel:{interval:0,rotate:-40,textStyle:{fontSize:12,color:"#fff"}},axisLine:{lineStyle:{color:"#fff"}}},yAxis:{min:0,type:"value",splitLine:{show:!0,lineStyle:{type:"dashed"}},axisLabel:{textStyle:{fontSize:12,color:"#fff"}},axisLine:{show:!1,lineStyle:{color:"#fff"}}},series:s};i.setOption(n)},getDuiBi:function(t,e,i,a){var s=this,n={mid:t,ip_id:e,tid:i,time:a},o=this.$gscookie.getCookie("gun"),c=this.$store.state.key,d=this.$methods.mkSign(n,c),l=new URLSearchParams;l.append("sign",d),l.append("token",o),l.append("mid",n.mid),l.append("ip_id",n.ip_id),l.append("tid",n.tid),l.append("time",n.time),this.$axios({url:this.$store.state.baseURL+"/weixin/project/index.php?m=Home&c=Index&a=alarm_anal",method:"POST",changeOrigin:!0,data:l}).then(function(t){if(200==t.status){s.dbnames=t.data.mname,s.dbx=t.data.days,s.dblist=t.data.data;var e=t.data.content.length,i=0;s.dbtext="";var a=Object(r.setInterval)(function(){i<e?(s.dbtext+=t.data.content[i],i++):Object(r.clearInterval)(a)},100);s.duiBiEchart()}}).catch(function(t){console.log(t)})},typeChange:function(t){var e=this.warningType[t].checked;this.warningType[t].checked=!e},jigouSelect:function(t){var e=this.jigoulist[t].checked;this.jigoulist[t].checked=!e},subCheckDate:function(){var t,e,i,a=this.timeStart,s=this.timeEnd,n=this.warningType.filter(function(t){return t.checked}),o=this.jigoulist.filter(function(t){return t.checked});t=n.map(function(t){return t.id}).join(),e=o.map(function(t){return t.id}).join(),i=o.map(function(t){return t.ip_id}).join();var r=[a,s].join();this.getData(r,t,e,i)},move:function(){this.$methods.listMove("#list-new",3e3)},chartNew1:function(){var t=document.getElementById("echart-new1"),e=this.$echarts.init(t),i={tooltip:{},grid:{top:"5%"},legend:{data:["威胁值"],right:"10%",top:"5%",textStyle:{color:"#fff",fontSize:14}},xAxis:{data:this.rightData1,axisTick:{show:!1},axisLabel:{interval:0,rotate:25,textStyle:{color:"#fff",fontSize:12}},axisLine:{lineStyle:{type:"solid",color:"#fff",width:"1  "}}},yAxis:{splitLine:{show:!0,lineStyle:{color:"#3a6785",width:1,type:"solid"}},axisLabel:{textStyle:{color:"#fff",fontSize:12}},axisLine:{show:!1}},series:[{name:"数量",type:"bar",barWidth:30,data:this.rightData2,itemStyle:{normal:{color:new this.$echarts.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"#06B5D7"},{offset:.5,color:"#44C0C1"},{offset:1,color:"#71C8B1"}])},emphasis:{color:new this.$echarts.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"#71C8B1"},{offset:.7,color:"#44C0C1"},{offset:1,color:"#06B5D7"}])}}}]};e.setOption(i)},chartNew2:function(){var t=this,e=document.getElementById("echart-new2"),i=this.$echarts.init(e);var a={name:"入套报警",type:"line",stack:"总量",symbol:"circle",symbolSize:8,itemStyle:{normal:{color:"#0092f6",lineStyle:{color:"#0092f6",width:1},areaStyle:{color:"#94C9EC"}}},markPoint:{itemStyle:{normal:{color:"red"}}},data:[]},s=[];t.rightData1.forEach(function(e,i){var n="rgba("+Math.floor(256*Math.random())+","+Math.floor(256*Math.random())+","+Math.floor(256*Math.random())+",0.4)",r=o()({},a,{name:e,itemStyle:{normal:{color:n,areaStyle:{color:n}}},data:t.series[i]});s.push(r)});var n={title:{text:"各类型报警占比",top:"3%",left:"center",textStyle:{color:"#FFF",align:"center"}},grid:{left:"2%",right:"2%",top:"20%",bottom:"5%",containLabel:!0},tooltip:{show:!0,trigger:"item"},legend:{show:!0,x:"center",top:"12%",y:"35",icon:"stack",itemWidth:10,itemHeight:10,textStyle:{color:"#1bb4f6"},data:t.rightData1},xAxis:[{type:"category",boundaryGap:!1,axisLabel:{color:"#30eee9"},axisLine:{show:!0,lineStyle:{color:"#397cbc"}},axisTick:{show:!1},splitLine:{show:!1,lineStyle:{color:"#3a6785"}},data:t.echar_date}],yAxis:[{type:"value",name:"数量",min:0,axisLabel:{formatter:"{value}",textStyle:{color:"#2ad1d2"}},axisLine:{lineStyle:{color:"#27b4c2"}},axisTick:{show:!1},splitLine:{show:!0,lineStyle:{color:"#11366e"}}},{type:"value",min:0,axisLabel:{formatter:"{value} %",textStyle:{color:"#186afe"}},axisLine:{lineStyle:{color:"#186afe"}},axisTick:{show:!1},splitLine:{show:!0,lineStyle:{color:"#3a6785"}}}],series:[]};n.series=s,i.setOption(n,!0)},getData:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",s=arguments[3],n={time:t};e&&(n={time:t,tid:e,mid:a,ip_id:s});var r=this.$gscookie.getCookie("gun"),c=this.$store.state.key,d=this.$methods.mkSign(n,c),l=new URLSearchParams;l.append("sign",d),l.append("token",r),l.append("time",n.time),e&&(l.append("tid",n.tid),l.append("mid",n.mid),l.append("ip_id",n.ip_id)),this.$axios({url:this.$store.state.baseURL+"/weixin/project/index.php?m=home&c=Index&a=alarm_info",method:"POST",changeOrigin:!0,data:l}).then(function(t){if(200==t.status){i.$gscookie.getCookie("message_obj");if(!i.jigoulist.length){i.jigoulist=t.data.data.mec.map(function(t,e){return 0===e?o()({},t,{checked:!0}):o()({},t,{checked:!1})}),i.dbjigoulist=t.data.data.mec.map(function(t,e){return o()({},t,{checked:!1})});var e=t.data.data.types.map(function(t){return o()({},t,{checked:!0})});i.warningType=e}i.echar_date=t.data.data.days,i.echar_num=t.data.data.value,i.echar1_names=t.data.data.mname,i.list=t.data.data.series,i.selected=t.data.data.selected,i.dataList=t.data.list;var a={};t.data.data.mname.forEach(function(t,e){a[t]=0==e}),i.selected=a,i.rightData1=t.data.data.type,i.rightData2=t.data.data.cou,i.chartNew1(),i.series=t.data.data.series,i.chartNew2()}}).catch(function(t){console.log(t)})}},created:function(){var t=this.$gscookie.getCookie("gun");"{}"==s()(t)&&this.$router.push("/loginput"),3==this.$gscookie.getCookie("message_obj").role_id&&this.$router.push({name:"HuiZong"});var e=this.$route.params;if(this.obj=e,"{}"!=s()(e)){this.timeStart=e[0],this.timeEnd=e[1];var i;i=this.warningType.filter(function(t){return t.checked}).map(function(t){return t.id}).join(),this.getData(e.join(),i)}else this.$router.push("/loginput")},mounted:function(){this.move(),this.$store.commit("setStr",{str1:"报警类型",str2:"趋势分析"})},destroyed:function(){this.$store.commit("huanyuanStr")}},d={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"wrap"},[i("div",{attrs:{id:"sel"}},[i("i",{staticClass:"jiao"}),t._v(" "),i("i",{staticClass:"jiao"}),t._v(" "),i("i",{staticClass:"jiao"}),t._v(" "),i("i",{staticClass:"jiao"}),t._v(" "),i("div",{staticClass:"items"},[t._m(0),t._v(" "),i("div",{staticClass:"sel-wrap"},[t._v("\r\n          查询时间：\r\n          "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.timeStart,expression:"timeStart"}],attrs:{type:"date"},domProps:{value:t.timeStart},on:{input:function(e){e.target.composing||(t.timeStart=e.target.value)}}}),t._v("\r\n          至\r\n          "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.timeEnd,expression:"timeEnd"}],attrs:{type:"date"},domProps:{value:t.timeEnd},on:{input:function(e){e.target.composing||(t.timeEnd=e.target.value)}}}),t._v(" "),t._e()])]),t._v(" "),i("div",{staticClass:"items"},[t._m(1),t._v(" "),i("div",{staticClass:"type-wrap"},t._l(t.warningType,function(e,a){return i("div",{key:a,staticClass:"item",class:{selected:e.checked},on:{click:function(e){t.typeChange(a)}}},[i("i"),t._v("\r\n            "+t._s(e.name)+"\r\n          ")])}))]),t._v(" "),i("div",{staticClass:"items"},[t._m(2),t._v(" "),i("div",{staticClass:"jg-wrap"},t._l(t.jigoulist,function(e,a){return i("div",{key:a,staticClass:"item",class:{selected:e.checked},on:{click:function(e){t.jigouSelect(a)}}},[i("i"),t._v("\r\n            "+t._s(e.mechanism_name)+"\r\n          ")])}))]),t._v(" "),i("div",{staticClass:"sub-wrap"},[i("div",{staticClass:"sub",on:{click:t.subCheckDate}},[t._v("确定")])]),t._v(" "),i("div",{staticClass:"fenxiduibi",on:{click:t.fenxi}},[t._v("对比分析")])]),t._v(" "),i("div",{attrs:{id:"second"}},[i("div",{staticClass:"left"},[i("div",{staticClass:"n"},[t._v("报警列表")]),t._v(" "),i("div",{staticClass:"c"},[t._m(3),t._v(" "),i("div",{staticClass:"awrap"},[i("div",{staticClass:"list-new",attrs:{id:"list-new"}},t._l(t.dataList,function(e,a){return i("div",{key:a,staticClass:"item"},[i("span",[t._v(t._s(e.mname))]),t._v(" "),i("span",[t._v(t._s(e.datetime))]),t._v(" "),i("span",[t._v(t._s(e.number))]),t._v(" "),i("span",{on:{click:function(i){t.toMore(e.number,e.datetime,e)}}},[t._v("查看详情")])])}))])])]),t._v(" "),t._m(4)]),t._v(" "),t._m(5),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.showFenXi,expression:"showFenXi"}],staticClass:"cover"},[i("div",{directives:[{name:"show",rawName:"v-show",value:1===t.steap,expression:"steap===1"}],staticClass:"alert"},[i("button",{on:{click:t.close}},[t._v("X")]),t._v(" "),i("div",{staticClass:"buzou"}),t._v(" "),t._m(6),t._v(" "),i("div",{staticClass:"selwrap"},[t._v("\r\n          查询时间 "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.dbtimestart,expression:"dbtimestart"}],attrs:{type:"date"},domProps:{value:t.dbtimestart},on:{input:function(e){e.target.composing||(t.dbtimestart=e.target.value)}}}),t._v("\r\n          至\r\n          "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.dbtimeend,expression:"dbtimeend"}],attrs:{type:"date"},domProps:{value:t.dbtimeend},on:{input:function(e){e.target.composing||(t.dbtimeend=e.target.value)}}})]),t._v(" "),i("div",{staticClass:"next",on:{click:t.next1}},[t._v("下一步")])]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:2===t.steap,expression:"steap===2"}],staticClass:"alert2"},[i("button",{on:{click:t.close}},[t._v("X")]),t._v(" "),i("div",{staticClass:"buzou"}),t._v(" "),t._m(7),t._v(" "),i("div",{staticClass:"typewrap"},t._l(t.dbwarningtype,function(e,a){return i("div",{key:a,staticClass:"item ",class:{selected:e.checked},on:{click:function(e){t.dbchecktype(a)}}},[i("i"),t._v(t._s(e.name)+"\r\n          ")])})),t._v(" "),i("div",{staticClass:"next",on:{click:t.next2}},[t._v("下一步")])]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:3===t.steap,expression:"steap===3"}],staticClass:"alert3"},[i("button",{on:{click:t.close}},[t._v("X")]),t._v(" "),i("div",{staticClass:"buzou"}),t._v(" "),t._m(8),t._v(" "),i("div",{staticClass:"typewrap"},t._l(t.dbjigoulist,function(e,a){return i("div",{key:a,staticClass:"item ",class:{selected:e.checked},on:{click:function(e){t.dbjigoucheck(a)}}},[i("i"),t._v(t._s(e.mechanism_name)+"\r\n          ")])})),t._v(" "),i("div",{staticClass:"next",on:{click:t.next3}},[t._v("下一步")])]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:4===t.steap,expression:"steap===4"}],staticClass:"alert4"},[i("button",{on:{click:t.close}},[t._v("X")]),t._v(" "),i("div",{attrs:{id:"dbchart"}}),t._v(" "),i("p",[t._v("分析结果")]),t._v(" "),i("div",{staticClass:"text"},[t._v("\r\n          "+t._s(t.dbtext)+"\r\n        ")]),t._v(" "),i("div",{staticClass:"next",on:{click:t.next4}},[t._v("关闭")])])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"title"},[e("span"),this._v("\r\n          查询时间\r\n        ")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"title"},[e("span"),this._v("\r\n          报警类型\r\n        ")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"title"},[e("span"),this._v("\r\n          机构名称\r\n        ")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"tit"},[e("span",[this._v("机构名称")]),this._v(" "),e("span",[this._v("报警日期")]),this._v(" "),e("span",[this._v("报警数量")]),this._v(" "),e("span",[this._v("查看详情")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"right"},[e("div",{staticClass:"n"},[this._v("报警统计")]),this._v(" "),e("div",{staticClass:"c"},[e("div",{attrs:{id:"echart-new1"}})])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"three"}},[e("div",{attrs:{id:"echart-new2"}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"title"},[e("i"),this._v("查询时间\r\n        ")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"title"},[e("i"),this._v("报警类型\r\n        ")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"title"},[e("i"),this._v("机构名称\r\n        ")])}]};var l=i("VU/8")(c,d,!1,function(t){i("TvXH")},"data-v-0dc65252",null);e.default=l.exports},TvXH:function(t,e){}});
//# sourceMappingURL=34.398e6ec686f19cd26f81.js.map