webpackJsonp([7],{"/qq7":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("mvHQ"),s=a.n(i),n=a("Gu7T"),o=a.n(n),r=a("hWqa"),c=a("Dd8w"),l=a.n(c),p={props:{oneDate:{type:Object,default:function(){return{}}}},data:function(){return{xiangqingalert:!1,xiangqingData:null}},methods:{openalert:function(t){console.log(t),this.getXiangqing(t.id)},close:function(){this.xiangqingalert=!1},toHistory:function(t){this.$emit("toHistory",t)},toNew:function(t){this.$emit("toNew",t)},toAlarm:function(t){this.$router.push({name:"BaoJing",params:l()({one:!0},t)})},getXiangqing:function(t){var e=this,a=this.$store.state.key,i={id:t};console.log(i);var s=this.$methods.mkSign(i,a),n=this.$gscookie.getCookie("gun"),o=new URLSearchParams;o.append("id",i.id),o.append("sign",s),o.append("token",n),this.$axios({url:this.$store.state.baseURL+"/weixin/project/index.php?m=Home&c=Gunlibrary&a=gunlibrary",method:"POST",changeOrigin:!0,data:o}).then(function(t){200==t.status&&(console.log(t),e.xiangqingalert=!0,e.xiangqingData=t.data)}).catch(function(t){console.log(t)})}}},v={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"item"},[i("div",{staticClass:"imgwrap"},[t.oneDate.icon?i("img",{attrs:{src:t.oneDate.icon,alt:"警员"}}):t._e(),t._v(" "),t.oneDate.icon?t._e():i("img",{attrs:{src:a("NIoa"),alt:""}})]),t._v(" "),i("div",{staticClass:"textwrap"},[i("p",[t._v("警员："+t._s(t.oneDate.policeName))]),t._v(" "),i("p",[t._v("警号："+t._s(t.oneDate.policeNum))]),t._v(" "),i("p",[t._v("持枪证号："+t._s(t.oneDate.permitid))]),t._v(" "),i("p",[t._v("单位："+t._s(t.oneDate.mechanism_name))]),t._v(" "),i("p",[t._v("枪支编号："+t._s(t.oneDate.gunNum))]),t._v(" "),i("p",[t._v("持枪类型："+t._s(t.oneDate.bulletType))]),t._v(" "),i("p",[i("button",{on:{click:function(e){t.openalert(t.oneDate)}}},[t._v("查看详情")]),t._v(" "),i("button",{on:{click:function(e){t.toHistory(t.oneDate)}}},[t._v("历史轨迹")]),t._v(" "),i("button",{on:{click:function(e){t.toNew(t.oneDate)}}},[t._v("最新位置")])])]),t._v(" "),i("div",{staticClass:"mes-l"},[i("span"),t._v(" "),i("p",[t._v("审批人："+t._s(t.oneDate.aprName))]),t._v(" "),i("p",[t._v("用途："+t._s(t.oneDate.taskType))])]),t._v(" "),i("div",{staticClass:"mes-r",class:{alert:t.oneDate.state}},[t.oneDate.state?i("span",{staticStyle:{cursor:"pointer"},on:{click:function(e){t.toAlarm(t.oneDate)}}}):i("span"),t._v(" "),i("p",[t._v("借出时间："+t._s(t.oneDate.optime))]),t._v(" "),i("p",[t._v("预期归还时间："+t._s(t.oneDate.planreturntime))])]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.xiangqingalert,expression:"xiangqingalert"}],staticClass:"cover"},[t.xiangqingData?i("div",{staticClass:"alert"},[i("button",{staticClass:"del",on:{click:t.close}},[t._v("X")]),t._v(" "),i("div",{staticClass:"leftwrap"},[i("div",{staticClass:"box-l"},[i("div",{staticClass:"imgwrap"},[t.oneDate.icon?i("img",{attrs:{src:t.oneDate.icon,alt:"警员"}}):t._e(),t._v(" "),t.oneDate.icon?t._e():i("img",{attrs:{src:a("NIoa"),alt:""}})]),t._v(" "),i("div",{staticClass:"btnwrap"},[i("button",{on:{click:function(e){t.toNew(t.oneDate)}}},[t._v("最新轨迹")]),t._v(" "),i("button",{on:{click:function(e){t.toHistory(t.oneDate)}}},[t._v("历史轨迹")]),t._v(" "),i("button",[t._v("枪支状态异常")])]),t._v(" "),i("div",{staticClass:"iconwrap1"}),t._v(" "),i("div",{staticClass:"iconwrap2"})]),t._v(" "),i("div",{staticClass:"box-r"},[i("div",{staticClass:"text1"},[i("p",[i("i",[t._v("警员")]),i("i",[t._v("："+t._s(t.oneDate.policeName))])]),t._v(" "),i("p",[i("i",[t._v("IMEI")]),i("i",[t._v("："+t._s(t.oneDate.IMEI))])]),t._v(" "),i("p",[i("i",[t._v("手机号")]),i("i",[t._v("："+t._s(t.oneDate.phoneNum))])]),t._v(" "),i("p",[i("i",[t._v("单位")]),i("i",[t._v("："+t._s(t.oneDate.mechanism_name))])])]),t._v(" "),i("div",{staticClass:"text2"},[i("p",[i("i",[t._v("警号")]),i("i",[t._v("："+t._s(t.oneDate.policeNum))])]),t._v(" "),i("p",[i("i",[t._v("持枪证")]),i("i",[t._v("："+t._s(t.oneDate.permitid))])]),t._v(" "),i("p",[i("i",[t._v("枪支编号")]),i("i",[t._v("："+t._s(t.oneDate.gunNum))])]),t._v(" "),i("p",[i("i",[t._v("枪支类型")]),i("i",[t._v("："+t._s(t.oneDate.bulletType))])])]),t._v(" "),i("div",{staticClass:"text3"},[i("p",[t._v("本月出勤数量："+t._s(t.xiangqingData.btoal)+"条")]),t._v(" "),i("p",[t._v("出勤任务总量："+t._s(t.xiangqingData.toal)+"条")])]),t._v(" "),i("div",{staticClass:"text4"},[i("p",[t._v("离套报警数量："+t._s(t.xiangqingData.litao)+"条")]),t._v(" "),i("p",[t._v("区域报警数量："+t._s(t.xiangqingData.quyu)+"条")])])])]),t._v(" "),i("div",{staticClass:"mes mes1"},[i("p",[i("i",[t._v("出库时间：")]),i("i",[t._v(t._s(t.xiangqingData.optime))])]),t._v(" "),i("p",[i("i",[t._v("归还时间：")]),i("i",[t._v(t._s(t.xiangqingData.planreturntime))])])]),t._v(" "),i("div",{staticClass:"mes mes2"},[i("p",[i("i",[t._v("所属枪柜：")]),i("i",[t._v(t._s(t.xiangqingData.guncabinet_code))])]),t._v(" "),i("p",[i("i",[t._v("枪锁位：")]),i("i",[t._v(t._s(t.xiangqingData.gposition))])])]),t._v(" "),i("div",{staticClass:"mes mes3"},[i("p",[i("i",[t._v("枪支编号：")]),i("i",[t._v(t._s(t.xiangqingData.gun_code))])]),t._v(" "),i("p",[i("i",[t._v("枪支类型：")]),i("i",[t._v(t._s(t.xiangqingData.gunType))])])])]):t._e()])])},staticRenderFns:[]};var u=a("VU/8")(p,v,!1,function(t){a("AiqD")},"data-v-7720f864",null).exports,d=a("3Cqg"),_=(a("LdhR"),{components:{breadNav:r.a,onePerson:u,MapMarker:d.a},data:function(){return{mapShow:!1,active_title:"",currentNodeKey:"",selValue:"",putValue:"",treeListData:[],dataList:[],activeItem:"",pageTotal:0,defaultProps:{children:"child",label:"mechanism_name"},lixianMap:!1,lixianArr:[],lixianTitle:""}},methods:{closeMap:function(){this.lixianMap=!1},subSearch:function(){this.selValue?(this.putValue.trim()||this.$message("请输入关键字！"),this.search()):this.$message("请选择搜索的条件")},mapInit:function(t){var e=new AMap.Map("map-content",{center:[t.longitude,t.latitude],resizeEnable:!0,zoom:13}),a=new AMap.Marker({position:new AMap.LngLat(t.longitude,t.latitude),title:t.policeName});e.add(a),e.setFitView([].concat(o()(a)))},mapOff:function(){this.mapShow=!1,this.hasTime=!1},searchByTime:function(){this.hasTime=!1},toNew:function(t){t.longitude?(this.mapShow=!0,this.mapInit(t)):this.$message({type:"error",message:"该人员暂无轨迹信息"})},toHistory:function(t){t.longitude?this.$router.push({name:"GuiJi",params:t}):this.$message({type:"error",message:"该人员暂无轨迹信息"})},getTreeList:function(){var t=this,e=this.$store.state.key,a={p:1,ps:6,mechanism_id:1},i=this.$methods.mkSign(a,e),s=this.$gscookie.getCookie("gun"),n=new URLSearchParams;n.append("p",a.p),n.append("ps",a.ps),n.append("mechanism_id",a.mechanism_id),n.append("sign",i),n.append("token",s),this.$axios({url:this.$store.state.baseURL+"/weixin/project/index.php?m=home&c=mechanism&a=mechanisms_tree",method:"POST",changeOrigin:!0,data:n}).then(function(e){t.treeListData=e.data.data.list}).catch(function(t){console.log(t)}),this.hasData=!0},handleNodeClick:function(t){this.$refs.page.internalCurrentPage=1,this.activeItem=t,this.active_title=t.mechanism_name,this.getDataList(t.id)},getDataList:function(t){var e=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;t||(t=this.$gscookie.getCookie("mechanism_id"));var i=this.$store.state.key,s={id:t,page:a},n=this.$methods.mkSign(s,i),o=this.$gscookie.getCookie("gun"),r=new URLSearchParams;r.append("id",s.id),r.append("page",s.page),r.append("sign",n),r.append("token",o),this.$axios({url:this.$store.state.baseURL+"/weixin/project/index.php?m=home&c=Gunlibrary&a=index",method:"POST",changeOrigin:!0,data:r}).then(function(t){200==t.data.code&&(console.log(t.data.data),e.dataList=t.data.data,e.pageTotal=t.data.total-0)}).catch(function(t){console.log(t)})},currentChange:function(t){this.getDataList(this.activeItem.id,t)},search:function(){var t=this,e=this.selValue,a=this.putValue,i=this.$store.state.key,s={state:1};s[e]=a;var n=this.$methods.mkSign(s,i),o=this.$gscookie.getCookie("gun"),r=new URLSearchParams;r.append(e,s[e]),r.append("state",s.state),r.append("sign",n),r.append("token",o),this.$axios({url:this.$store.state.baseURL+"/weixin/project/index.php?m=home&c=Gunlibrary&a=index",method:"POST",changeOrigin:!0,data:r}).then(function(e){200==e.data.code&&(t.dataList=e.data.data,t.pageTotal=e.data.total-0,t.selValue="",t.putValue="")}).catch(function(t){console.log(t)})}},created:function(){this.getTreeList(),this.getDataList(),this.currentNodeKey=this.$gscookie.getCookie("mechanism_id"),3==this.$gscookie.getCookie("message_obj").role_id&&this.$router.push({name:"GuiJi"});var t=this.$gscookie.getCookie("gun");"{}"!=s()(t)||this.$router.push("/loginput")}}),h={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"chiqiang"},[a("div",{staticClass:"tree-menu"},[a("h3",[t._v("持枪人员")]),t._v(" "),a("div",{staticClass:"nav-wrap"},[a("el-tree",{attrs:{data:t.treeListData,props:t.defaultProps,"highlight-current":!0,accordion:"","node-key":"id","current-node-key":t.currentNodeKey,"default-expand-all":""},on:{"node-click":t.handleNodeClick}})],1)]),t._v(" "),a("div",{staticClass:"top-nav"},[a("div",{staticClass:"bread-wrap"},[a("breadNav",{attrs:{title:"持枪人员",next:t.active_title}})],1),t._v(" "),a("div",{staticClass:"search-wrap"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.selValue,expression:"selValue"}],staticClass:"sel",on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.selValue=e.target.multiple?a:a[0]}}},[a("option",{attrs:{value:"",disabled:"",selected:""}},[t._v("请选择搜索类型")]),t._v(" "),a("option",{attrs:{value:"uname"}},[t._v("警员姓名")]),t._v(" "),a("option",{attrs:{value:"police_number"}},[t._v("警员编号")])]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.putValue,expression:"putValue"}],staticClass:"textput",attrs:{type:"text",placeholder:"请输入搜素关键字"},domProps:{value:t.putValue},on:{keyup:function(e){return"button"in e||13===e.keyCode?t.subSearch(e):null},input:function(e){e.target.composing||(t.putValue=e.target.value)}}}),t._v(" "),a("button",{staticClass:"sub",on:{click:t.subSearch}})])]),t._v(" "),a("div",{staticClass:"page-index"},[a("el-pagination",{ref:"page",attrs:{"page-size":4,"pager-count":9,layout:"prev, pager, next",total:t.pageTotal},on:{"current-change":t.currentChange}})],1),t._v(" "),t.dataList?a("div",{staticClass:"content"},[t.dataList.length?t._e():a("div",{staticClass:"none-data"},[t._v("暂时没有数据......")]),t._v(" "),t._l(t.dataList,function(e){return a("onePerson",{key:e.id,attrs:{oneDate:e},on:{toNew:t.toNew,toHistory:t.toHistory}})})],2):t._e(),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.mapShow,expression:"mapShow"}],staticClass:"alert"},[a("div",{staticClass:"map_wrap"},[a("div",{attrs:{id:"map-content"}}),t._v(" "),a("button",{staticClass:"del",on:{click:t.mapOff}},[t._v("取消")]),t._v(" "),a("div",{staticClass:"del2",on:{click:t.mapOff}},[t._v("X")])])]),t._v(" "),t.lixianMap?a("MapMarker",{attrs:{arr:t.lixianArr,title:t.lixianTitle},on:{closeMap:t.closeMap}}):t._e()],1)},staticRenderFns:[]};var m=a("VU/8")(_,h,!1,function(t){a("4NwT")},"data-v-7ffa0421",null);e.default=m.exports},"4NwT":function(t,e){},AiqD:function(t,e){},LdhR:function(t,e,a){"use strict";var i=a("Gu7T"),s=a.n(i),n={props:["arr","title"],data:function(){return{BM:null,map:null}},methods:{closeMap:function(){this.$emit("closeMap")},mapInit:function(t){var e=this.arr[0]>this.arr[1]?[this.arr[0],this.arr[1]]:[this.arr[1],this.arr[0]],a=new AMap.Map("map",{center:e,resizeEnable:!0,zoom:13});this.map=a,this.setMarker(e)},setMarker:function(t){var e=t||[116.397428,39.90923],a=new AMap.Marker({position:new(Function.prototype.bind.apply(AMap.LngLat,[null].concat(s()(e)))),title:this.title});this.map.add(a),this.map.setFitView([].concat(s()(a)))}},mounted:function(){this.mapInit()}},o={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"wrap"},[e("div",{staticClass:"map_wrap"},[e("div",{attrs:{id:"map"}}),this._v(" "),e("button",{staticClass:"close",on:{click:this.closeMap}},[this._v("取消")]),this._v(" "),e("div",{staticClass:"del",on:{click:this.closeMap}},[this._v("X")])])])},staticRenderFns:[]};var r=a("VU/8")(n,o,!1,function(t){a("Peo6")},"data-v-257fa722",null);e.a=r.exports},Peo6:function(t,e){}});
//# sourceMappingURL=7.f121b53d39c37dc71162.js.map